{"version":3,"file":"index.js","sources":["../src/options.ts","../src/constants.ts","../src/cssHandler.ts","../src/queries.ts","../src/script.ts","../src/jsHandler.ts","../src/index.ts"],"sourcesContent":["import { Options, HandleMobileOptions, TransformPixelsOptions } from './types'\n\nexport const optionDefaults: Options = {\n  appEntry: undefined,\n  handleMobile: true,\n  transformPixels: false\n}\n\nexport const handleMobileDefaults: HandleMobileOptions = {\n  ignoreSelectors: [],\n  centralizeText: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p'],\n  breakpoint: '480px'\n}\n\nexport const transformPixelsDefault: TransformPixelsOptions = {\n  ignoreAttributes: [],\n  ignoreSelectors: []\n}","export const htmlTagBaseFontSize = 16\nexport const ignoreResponsiveAppClass = 'ignore-responsive-app'\nexport const indexHtmlFile = '/index.html'\nexport const appEntryPoints = [indexHtmlFile, '/app.js', '/main.js', 'src/index.js']","import MagicString from 'magic-string'\nimport { Options, TransformPixelsOptions, HandleMobileOptions } from './types'\nimport { htmlTagBaseFontSize, ignoreResponsiveAppClass } from './constants'\nimport { handleMobileDefaults, transformPixelsDefault } from './options'\n\nconst pxToRemRegExp = /(\\d+)px/g\nconst cssSelectorRegExp = /([.#\\w\\-\\s,:]+)\\s*\\{([^}]+?)\\}/gs\nconst propRegex = /([\\w-]+)\\s*:\\s*([^}]+)/g\n\nfunction getRemValue(value: number) {\n  return (value / htmlTagBaseFontSize).toFixed(4).replace(/[.,]0+$/, \"\")\n}\n\nfunction getPropertyRemValue(value: string) {\n  return value.replace(/[0-9]+px/g, (match: string) => {\n    return getRemValue(Number(match.replace('px', ''))) + 'rem'\n  })\n}\n\nfunction transformPixels(code: string, options: TransformPixelsOptions) {\n  const cssMap = new Map()\n  let match\n\n  while ((match = cssSelectorRegExp.exec(code)) !== null) {\n    const selector = match[1].trim()\n    const properties = match[2].trim()\n\n    if (options.ignoreSelectors.some(i => selector.includes(i))) {\n      continue\n    }\n\n    const pxProperties = []\n    let propMatch\n\n    while ((propMatch = propRegex.exec(properties)) !== null) {\n      const key = propMatch[1].trim()\n      const value = propMatch[2].trim()\n\n      if (value.includes('px') && !options.ignoreAttributes.includes(key)) {\n        pxProperties.push({ key, value })\n      }\n    }\n\n    if (pxProperties.length > 0) {\n      cssMap.set(selector, pxProperties)\n    }\n  }\n\n  let transformationDefinitions = ''\n\n  if (cssMap.size > 0) {\n    cssMap.forEach((properties, key) => {\n      transformationDefinitions += `${key}:not(.${ignoreResponsiveAppClass}){`\n      properties.forEach((prop: { key: string, value: string }, index: number) => {\n        const isLast = index === properties.length - 1\n        transformationDefinitions += `${prop.key}:${getPropertyRemValue(prop.value)}${isLast ? '' : ''}`\n      })\n      transformationDefinitions += '}'\n    })\n  }\n\n  return transformationDefinitions\n}\n\nfunction handleMobile(code: string, options: HandleMobileOptions) {\n  const selectors = new Set()\n  let match\n\n  while ((match = cssSelectorRegExp.exec(code)) !== null) {\n    const selector = match[1].trim()\n    const properties = match[2].trim()\n    if (options.ignoreSelectors.some(i => selector.includes(i))) {\n      continue\n    }\n\n    let hasDisplayFlex = false\n    let hasFlexDirectionColumn = false\n\n    let propMatch\n\n    while ((propMatch = propRegex.exec(properties)) !== null) {\n      const key = propMatch[1].trim()\n      const value = propMatch[2].trim()\n\n      if (key === 'display' && value === 'flex') {\n        hasDisplayFlex = true\n      }\n      if (key === 'flex-direction' && value === 'column') {\n        hasFlexDirectionColumn = true\n      }\n    }\n    if (hasDisplayFlex && !hasFlexDirectionColumn) {\n      selectors.add(selector)\n    }\n  }\n\n  let transformationDefinitions = ''\n\n  if (selectors.size > 0) {\n    transformationDefinitions = `@media only screen and (max-width: ${options.breakpoint}) and (orientation: portrait){`\n    selectors.forEach((key) => {\n      transformationDefinitions += `${key}:not(.${ignoreResponsiveAppClass}){flex-direction: column; margin-left: 0; margin-right: 0}`\n    })\n    transformationDefinitions += '}'\n  }\n\n  return transformationDefinitions\n}\n\nfunction findInsertionIndex(str: string) {\n  const openingQuoteStatements = [\n    'const __vite__css = \"',\n    'export default \"'\n  ]\n  let closingQuoteIndex = -1\n  let searchString\n  let startIndex\n\n  do {\n    searchString = openingQuoteStatements.pop()\n    startIndex = searchString ? str.indexOf(searchString) : -1\n    if (searchString && startIndex !== -1) {\n      const openQuoteIndex = startIndex + searchString.length - 1\n      closingQuoteIndex = str.indexOf('\"', openQuoteIndex + 1)\n    }\n  } while (searchString && startIndex === -1)\n\n  return closingQuoteIndex\n}\n\nexport default (options: Options, code: string, id: string) => {\n  const transformPixelsParams = {\n    ...transformPixelsDefault,\n    ...(typeof options.transformPixels === 'object' ? options.transformPixels : {})\n  }\n  const handleMobileParams = {\n    ...handleMobileDefaults,\n    ...(typeof options.handleMobile === 'object' ? options.handleMobile : {})\n  }\n\n  let transformedCode = ''\n  transformedCode += options.transformPixels ? transformPixels(code, transformPixelsParams) : ''\n  transformedCode += options.handleMobile ? handleMobile(code, handleMobileParams) : ''\n\n  if (transformedCode) {\n    const magicString = new MagicString(code)\n    const index = findInsertionIndex(code)\n    if (index !== -1) {\n      magicString.prependLeft(index, transformedCode)\n    } else if (code.charAt(code.length - 1) === '\"') {\n      magicString.replace(/\"$/, `${transformedCode}\"`)\n    } else {\n      magicString.append(transformedCode)\n    }\n\n    return {\n      code: magicString.toString(),\n      map: magicString.generateMap({\n        source: id,\n        file: id,\n        includeContent: true\n      })\n    }\n  }\n\n  return null\n}","export default `\n:root {\n  --v-rem: 32;\n}\n@media (orientation: landscape) and (max-width: 2480px), (orientation: landscape) and (max-height: 1395px) {\n  :root {\n    --v-rem: 31;\n }\n}\n@media (orientation: landscape) and (max-width: 2400px), (orientation: landscape) and (max-height: 1350px) {\n  :root {\n    --v-rem: 30;\n }\n}\n@media (orientation: landscape) and (max-width: 2320px), (orientation: landscape) and (max-height: 1305px) {\n  :root {\n    --v-rem: 29;\n }\n}\n@media (orientation: landscape) and (max-width: 2240px), (orientation: landscape) and (max-height: 1260px) {\n  :root {\n    --v-rem: 28;\n }\n}\n@media (orientation: landscape) and (max-width: 2160px), (orientation: landscape) and (max-height: 1215px) {\n  :root {\n    --v-rem: 27;\n }\n}\n@media (orientation: landscape) and (max-width: 2080px), (orientation: landscape) and (max-height: 1170px) {\n  :root {\n    --v-rem: 26;\n }\n}\n@media (orientation: landscape) and (max-width: 2000px), (orientation: landscape) and (max-height: 1125px) {\n  :root {\n    --v-rem: 25;\n }\n}\n@media (orientation: landscape) and (max-width: 1920px), (orientation: landscape) and (max-height: 1080px) {\n  :root {\n    --v-rem: 24;\n }\n}\n@media (orientation: landscape) and (max-width: 1840px), (orientation: landscape) and (max-height: 1035px) {\n  :root {\n    --v-rem: 23;\n }\n}\n@media (orientation: landscape) and (max-width: 1760px), (orientation: landscape) and (max-height: 990px) {\n  :root {\n    --v-rem: 22;\n }\n}\n@media (orientation: landscape) and (max-width: 1680px), (orientation: landscape) and (max-height: 945px) {\n  :root {\n    --v-rem: 21;\n }\n}\n@media (orientation: landscape) and (max-width: 1600px), (orientation: landscape) and (max-height: 900px) {\n  :root {\n    --v-rem: 20;\n }\n}\n@media (orientation: landscape) and (max-width: 1520px), (orientation: landscape) and (max-height: 855px) {\n  :root {\n    --v-rem: 19;\n }\n}\n@media (orientation: landscape) and (max-width: 1440px), (orientation: landscape) and (max-height: 810px) {\n  :root {\n    --v-rem: 18;\n }\n}\n@media (orientation: landscape) and (max-width: 1360px), (orientation: landscape) and (max-height: 765px) {\n  :root {\n    --v-rem: 17;\n }\n}\n@media (orientation: landscape) and (max-width: 1280px), (orientation: landscape) and (max-height: 720px) {\n  :root {\n    --v-rem: 16;\n }\n}\n@media (orientation: landscape) and (max-width: 1200px), (orientation: landscape) and (max-height: 675px) {\n  :root {\n    --v-rem: 15;\n }\n}\n@media (orientation: landscape) and (max-width: 1120px), (orientation: landscape) and (max-height: 630px) {\n  :root {\n    --v-rem: 14;\n }\n}\n@media (orientation: landscape) and (max-width: 1040px), (orientation: landscape) and (max-height: 585px) {\n  :root {\n    --v-rem: 13;\n }\n}\n@media (orientation: landscape) and (max-width: 960px), (orientation: landscape) and (max-height: 540px) {\n  :root {\n    --v-rem: 12;\n }\n}\n@media (orientation: landscape) and (max-width: 880px), (orientation: landscape) and (max-height: 495px) {\n  :root {\n    --v-rem: 11;\n }\n}\n@media (orientation: landscape) and (max-width: 800px), (orientation: landscape) and (max-height: 450px) {\n  :root {\n    --v-rem: 10;\n }\n}\n@media (orientation: landscape) and (max-width: 720px), (orientation: landscape) and (max-height: 405px) {\n  :root {\n    --v-rem: 9;\n }\n}\n@media (orientation: landscape) and (max-width: 640px), (orientation: landscape) and (max-height: 360px) {\n  :root {\n    --v-rem: 8;\n }\n}\n@media (orientation: landscape) and (max-width: 560px), (orientation: landscape) and (max-height: 315px) {\n  :root {\n    --v-rem: 7;\n }\n}\n@media (orientation: landscape) and (max-width: 480px), (orientation: landscape) and (max-height: 270px) {\n  :root {\n    --v-rem: 6;\n }\n}\n@media (orientation: landscape) and (max-width: 400px), (orientation: landscape) and (max-height: 225px) {\n  :root {\n    --v-rem: 5;\n }\n}\n@media (orientation: landscape) and (max-width: 320px), (orientation: landscape) and (max-height: 180px) {\n  :root {\n    --v-rem: 4;\n }\n}\n@media (orientation: landscape) and (max-width: 240px), (orientation: landscape) and (max-height: 135px) {\n  :root {\n    --v-rem: 3;\n }\n}\n@media (orientation: landscape) and (max-width: 160px), (orientation: landscape) and (max-height: 90px) {\n  :root {\n    --v-rem: 2;\n }\n}\n@media (orientation: landscape) and (max-width: 80px), (orientation: landscape) and (max-height: 45px) {\n  :root {\n    --v-rem: 1;\n }\n}\n@media (orientation: portrait) and (max-width: 1395px), (orientation: portrait) and (max-height: 2480px) {\n  :root {\n    --v-rem: 31;\n }\n}\n@media (orientation: portrait) and (max-width: 1350px), (orientation: portrait) and (max-height: 2400px) {\n  :root {\n    --v-rem: 30;\n }\n}\n@media (orientation: portrait) and (max-width: 1305px), (orientation: portrait) and (max-height: 2320px) {\n  :root {\n    --v-rem: 29;\n }\n}\n@media (orientation: portrait) and (max-width: 1260px), (orientation: portrait) and (max-height: 2240px) {\n  :root {\n    --v-rem: 28;\n }\n}\n@media (orientation: portrait) and (max-width: 1215px), (orientation: portrait) and (max-height: 2160px) {\n  :root {\n    --v-rem: 27;\n }\n}\n@media (orientation: portrait) and (max-width: 1170px), (orientation: portrait) and (max-height: 2080px) {\n  :root {\n    --v-rem: 26;\n }\n}\n@media (orientation: portrait) and (max-width: 1125px), (orientation: portrait) and (max-height: 2000px) {\n  :root {\n    --v-rem: 25;\n }\n}\n@media (orientation: portrait) and (max-width: 1080px), (orientation: portrait) and (max-height: 1920px) {\n  :root {\n    --v-rem: 24;\n }\n}\n@media (orientation: portrait) and (max-width: 1035px), (orientation: portrait) and (max-height: 1840px) {\n  :root {\n    --v-rem: 23;\n }\n}\n@media (orientation: portrait) and (max-width: 990px), (orientation: portrait) and (max-height: 1760px) {\n  :root {\n    --v-rem: 22;\n }\n}\n@media (orientation: portrait) and (max-width: 945px), (orientation: portrait) and (max-height: 1680px) {\n  :root {\n    --v-rem: 21;\n }\n}\n@media (orientation: portrait) and (max-width: 900px), (orientation: portrait) and (max-height: 1600px) {\n  :root {\n    --v-rem: 20;\n }\n}\n@media (orientation: portrait) and (max-width: 855px), (orientation: portrait) and (max-height: 1520px) {\n  :root {\n    --v-rem: 19;\n }\n}\n@media (orientation: portrait) and (max-width: 810px), (orientation: portrait) and (max-height: 1440px) {\n  :root {\n    --v-rem: 18;\n }\n}\n@media (orientation: portrait) and (max-width: 765px), (orientation: portrait) and (max-height: 1360px) {\n  :root {\n    --v-rem: 17;\n }\n}\n@media (orientation: portrait) and (max-width: 720px), (orientation: portrait) and (max-height: 1280px) {\n  :root {\n    --v-rem: 16;\n }\n}\n@media (orientation: portrait) and (max-width: 675px), (orientation: portrait) and (max-height: 1200px) {\n  :root {\n    --v-rem: 15;\n }\n}\n@media (orientation: portrait) and (max-width: 630px), (orientation: portrait) and (max-height: 1120px) {\n  :root {\n    --v-rem: 14;\n }\n}\n@media (orientation: portrait) and (max-width: 585px), (orientation: portrait) and (max-height: 1040px) {\n  :root {\n    --v-rem: 13;\n }\n}\n@media (orientation: portrait) and (max-width: 540px), (orientation: portrait) and (max-height: 960px) {\n  :root {\n    --v-rem: 12;\n }\n}\n@media (orientation: portrait) and (max-width: 495px), (orientation: portrait) and (max-height: 880px) {\n  :root {\n    --v-rem: 11;\n }\n}\n@media (orientation: portrait) and (max-width: 450px), (orientation: portrait) and (max-height: 800px) {\n  :root {\n    --v-rem: 10;\n }\n}\n@media (orientation: portrait) and (max-width: 405px), (orientation: portrait) and (max-height: 720px) {\n  :root {\n    --v-rem: 9;\n }\n}\n@media (orientation: portrait) and (max-width: 360px), (orientation: portrait) and (max-height: 640px) {\n  :root {\n    --v-rem: 8;\n }\n}\n@media (orientation: portrait) and (max-width: 315px), (orientation: portrait) and (max-height: 560px) {\n  :root {\n    --v-rem: 7;\n }\n}\n@media (orientation: portrait) and (max-width: 270px), (orientation: portrait) and (max-height: 480px) {\n  :root {\n    --v-rem: 6;\n }\n}\n@media (orientation: portrait) and (max-width: 225px), (orientation: portrait) and (max-height: 400px) {\n  :root {\n    --v-rem: 5;\n }\n}\n@media (orientation: portrait) and (max-width: 180px), (orientation: portrait) and (max-height: 320px) {\n  :root {\n    --v-rem: 4;\n }\n}\n@media (orientation: portrait) and (max-width: 135px), (orientation: portrait) and (max-height: 240px) {\n  :root {\n    --v-rem: 3;\n }\n}\n@media (orientation: portrait) and (max-width: 90px), (orientation: portrait) and (max-height: 160px) {\n  :root {\n    --v-rem: 2;\n }\n}\n@media (orientation: portrait) and (max-width: 45px), (orientation: portrait) and (max-height: 80px) {\n  :root {\n    --v-rem: 1;\n }\n}\n`","import queries from './queries'\n\nexport default () => {\n  return `\n    if (typeof window !== 'undefined') {\n      const baseFontSize = 16\n    \n      const updateHtmlFontSize = function() {\n        const htmlElement = document.querySelector('html');\n        htmlElement.style.removeProperty('font-size');\n        const browserFontSize = window.getComputedStyle(htmlElement).getPropertyValue('font-size');\n\n        const browserDifference = Number(browserFontSize.replace('px', '')) - baseFontSize;\n\n        const vRem = window.getComputedStyle(document.documentElement).getPropertyValue('--v-rem');\n        const fontSize = Number(vRem) + Number(browserDifference)\n        htmlElement.style.setProperty('font-size', fontSize + 'px')\n      }\n\n      const addVirtualRemQueries = function() {\n        const style = document.createElement('style')\n        style.setAttribute('type', 'text/css')\n        style.setAttribute('data-magic-responsive', 'true')\n        style.textContent = \\\"${queries.replace(/\\n/g, '')}\\\"\n        document.head.appendChild(style)\n      }\n\n      const initResponsive = function() {\n        window.addEventListener('resize', updateHtmlFontSize)\n        addVirtualRemQueries()\n        updateHtmlFontSize()\n      }\n\n      if (window.document.readyState !== 'loading') {\n        initResponsive();\n      } else {\n        window.document.addEventListener('DOMContentLoaded', function() {\n          initResponsive();\n        });\n      }\n    }`\n}","import MagicString from 'magic-string'\nimport { indexHtmlFile } from './constants'\nimport getResponsiveScript from './script'\n\nexport default (code: string, id: string) => {\n  const magicString = new MagicString(code)\n  const isHtmlFile = id.includes(indexHtmlFile)\n  if (isHtmlFile) {\n    const index = code.indexOf('</body>')\n    magicString.prependLeft(index, `<script>${getResponsiveScript()}</script>`)\n  } else {\n    magicString.append(`\\n\\n(function() {\\n${getResponsiveScript()}\\n}())`)\n  }\n\n  return {\n    code: magicString.toString(),\n    map: magicString.generateMap({\n      source: id,\n      file: id,\n      includeContent: true\n    })\n  }\n}","import { Options } from './types'\nimport { optionDefaults } from './options'\nimport { indexHtmlFile, appEntryPoints } from './constants'\nimport handleCss from './cssHandler'\nimport handleJs from './jsHandler'\n\nlet hasAddedScript = false\n\nexport default function(data?: Options) {\n  const options: Options = {\n    ...optionDefaults,\n    ...(data || {})\n  }\n\n  return {\n    name: 'responsive-app-rollup-plugin',\n\n    transform: {\n      order: 'post',\n      handler(code: string, id: string) {\n        if ((options.handleMobile || options.transformPixels) && id.includes('.css')) {\n          return handleCss(options, code, id)\n        }\n\n        const isOptionEntryPoint = options.appEntry && id.includes(options.appEntry)\n        const isDefaultEntryPoint = !options.appEntry && appEntryPoints.some(i => id.includes(i)) && !id.includes('/server')\n\n        if (!hasAddedScript && (isOptionEntryPoint || isDefaultEntryPoint)) {\n          hasAddedScript = true\n          return handleJs(code, id)\n        }\n\n        return null\n      },\n    },\n  }\n}"],"names":[],"mappings":"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"}